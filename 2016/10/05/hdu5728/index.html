<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>hdu 5728 PowMod 数论 | ——Light!</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">hdu 5728 PowMod 数论</h1><a id="logo" href="/blog/.">——Light!</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> 首页</i></a><a href="/blog/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/blog/about/"><i class="fa fa-user"> 关于</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">hdu 5728 PowMod 数论</h1><div class="post-meta">Oct 5, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><h3 id="PowMod"><a href="#PowMod" class="headerlink" title="PowMod"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5728" target="_blank" rel="noopener">PowMod</a></h3><p>先贴官方题解</p>
<p><img src="http://img.blog.csdn.net/20160724151613409" alt="官方题解"></p>
<p>其中第二段根本不懂。。。然后就去学习了一下</p>
<p>引理：设 p 为 n 的一个质因数，<br>$$if\quad p^2|n\quad then\quad \varphi(n)=\varphi(\frac{n}{p})\times p\quad else\quad \varphi(n)=\varphi(\frac{n}{p})\times \varphi(p)$$<br>前一部分可以用 $\varphi(n)$ 的定义来证明，后一部分就是积性函数的性质(详见<a href="http://blog.csdn.net/summonlight/article/details/51967425" target="_blank" rel="noopener">欧拉函数为什么是积性函数</a>)</p>
<p>题中<code>n is a square-free number</code>表示 $n$ 没有平方因子。<br>我们设 $p$ 为 $n$ 的一个质因数，对 $p\mid i$ 的情况分类讨论：<br>$$\sum_{i=1}^{m}\varphi(i\times n)=\sum_{p\nmid i}^{m}\varphi(i\times n)+\sum_{p\mid i}^{m}\varphi(i\times n) \\<br>=\varphi(p)\times \sum_{p\nmid i}^{m}\varphi(i\times \frac{n}{p})+p\times \sum_{p\mid i}^{m}\varphi(i\times \frac{n}{p}) \\<br>(\because\ p\ is\ a\ prime\ number) \\<br>=\varphi(p)\times \sum_{p\nmid i}^{m}\varphi(i\times \frac{n}{p})+(\varphi(p)+1)\times \sum_{p\mid i}^{m}\varphi(\frac{i}{p}\times n) \\<br>(\because p\mid i\ 和\ p\nmid i\ 合并为全集 ) \\<br>=\varphi(p)\times \sum_{i=1}^{m}\varphi(i\times \frac{n}{p})+\sum_{p\mid i}^{m}\varphi(\frac{i}{p}\times n) \\<br>=\varphi(p)\times \sum_{i=1}^{m}\varphi(i\times \frac{n}{p})+\sum_{i=1}^{m/p}\varphi(i\times n)$$</p>
<p>再解释另一个式子：$a^b\equiv a^{\varphi(p)+b\%\varphi(p)}\pmod p$，我们分两种情况：</p>
<ol>
<li>$a$与$p$互质，那么由费马-欧拉定理，$a^{\varphi(p)}\equiv 1 \pmod p$，原式成立；</li>
<li>$a$与$p$不互质，则$a^x$在$\varphi(p)$次之内就会变为0。需要一个条件，$b\geq \varphi(p)$，那么实际上$a^b\equiv a^{\varphi(p)+b\%\varphi(p)}\equiv 0 \pmod p$，原式成立。</li>
</ol>
<p>但是为什么满足$b\geq \varphi(p)$我还是觉得很难解释，代码是抄标程的：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD=<span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e7</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">bool</span> b[N];</div><div class="line"><span class="keyword">int</span> phi[N],s[N],prime[<span class="number">700000</span>];</div><div class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">getphi</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    phi[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;i++) &#123;</div><div class="line">        <span class="keyword">if</span> (!b[i]) &#123;</div><div class="line">            phi[i]=i<span class="number">-1</span>;</div><div class="line">            prime[++tot]=i;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=tot;j++) &#123;</div><div class="line">            <span class="keyword">if</span> (i\times prime[j]&gt;=N) <span class="keyword">break</span>;</div><div class="line">            b[i\times prime[j]]=<span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (i%prime[j]==<span class="number">0</span>) &#123;</div><div class="line">                phi[i\times prime[j]]=phi[i]\times prime[j];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                phi[i\times prime[j]]=phi[i]\times (prime[j]<span class="number">-1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    s[<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i++)</div><div class="line">        s[i]=(s[i<span class="number">-1</span>]+phi[i])%MOD;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (m==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (m==<span class="number">1</span>) <span class="keyword">return</span> phi[n];</div><div class="line">    <span class="keyword">if</span> (n==<span class="number">1</span>) <span class="keyword">return</span> s[m];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=tot;i++) &#123;</div><div class="line">        <span class="keyword">if</span> (n%prime[i]==<span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> (<span class="number">1L</span>L\times (prime[i]<span class="number">-1</span>)\times getsum(n/prime[i],m)%MOD+getsum(n,m/prime[i]))%MOD;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x,<span class="keyword">int</span> n,<span class="keyword">int</span> M)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> res=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (n) &#123;</div><div class="line">        <span class="keyword">if</span> (n&amp;<span class="number">1</span>) res=res\times x%M;</div><div class="line">        x=x\times x%M;</div><div class="line">        n&gt;&gt;=<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> k,<span class="keyword">int</span> p)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (p==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> now=solve(k,phi[p]);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(k,phi[p]+now,p);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n,m,p;</div><div class="line">    getphi();</div><div class="line"><span class="comment">//    printf("%d\n",tot);</span></div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;p)!=EOF) &#123;</div><div class="line">        <span class="keyword">int</span> k=getsum(n,m);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve(k,p));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>本篇博客借助 markdown 高清重制~~</p>
</div><script type="text/javascript" src="/blog/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://Smlight.github.io/blog/2016/10/05/hdu5728/" data-id="cjelfq3t50025e4uim7k37vok" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACL0lEQVR42u3aQXLDIAwF0N7/0uk2izb+X7idMTyvMpkYeCwUCfH1FT+vt+f9m98+v3+TjDx7t34wMDAey3h9fD4z8ok//zKZ92JGDAyMAxhJKMzfSsZsw/rFOBgYGBi/MNpksQ2mGBgYGDNGnia2CSUGBgbGZ0Yb+JLJkumTwH1zLY6BgfFAxuz4/n8+/0l/AwMD41GMV/ncVejmITVaFQYGxtaMPMDlvFlC2QZcDAyMcxizw69ZA6DN8fLGJwYGxt6MNvDliV2+ETngYhwMDIwDGCtDJ4VunlAOL59hYGAcxpiVpm2h227fxbsYGBibMlYmy3+TLK4Or7NdwcDAeCAjSfjakJocurUHakXiiIGBsTWjbV4mx3D5EtvfFCEYAwNjC8ZKWGxbAm3SWbAxMDC2ZtTNwmDK9oJFu6HD4TAwMB7LaJuXK0vMS9y8dYqBgXECoz10m6WGecK30kLAwMA4jTE8go+XuH4VIwq4GBgYWzNmTcpZgG43cfi/gYGB8VhGXjS24PZALX9+WBUGBsYxjPrl+EpEEkzbkesMFAMDYyNGG2Tb9uSsML4ogDEwMDZlrCRksxRwJUxfHK5hYGBsyrjrcD8/GrtrO9prHxgYGE9ntIVr0gyYXQgrmpSzncbAwHg4496DsPbCRL7cpXsiGBgYhzHakrUtR9sLGRgYGBht8F0PxPXFDgwMjAMYbTNg1kjIAUkhjYGBcQ6jLR1ni2iveeWHfRgYGFszvgHEjrJQE8gayAAAAABJRU5ErkJggg==">分享</a><div class="tags"><a href="/blog/tags/ACM/">ACM</a></div><div class="post-nav"><a class="pre" href="/blog/2016/10/07/2016东北四省赛/">2016 东北四省赛 不科学の题解</a><a class="next" href="/blog/2016/10/05/hdu5919/">hdu 5919 Sequence II 主席树</a></div><div id="container"></div><link rel="stylesheet" href="/blog/css/default.css?v=0.0.0"><script src="/blog/js/gitment.browser.js?v=0.0.0"></script><script>var gitment = new Gitment({
  owner: 'Smlight',
  repo: 'blog',
  oauth: {
    client_id: '7658f04ebf4c82b4eaf5',
    client_secret: '9f2eab43096f966e8d6c53b81691ab45d3fe5009',
  },
})
gitment.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/blog/tags/ACM/" style="font-size: 15px;">ACM</a> <a href="/blog/tags/Life/" style="font-size: 15px;">Life</a> <a href="/blog/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/blog/tags/Bug/" style="font-size: 15px;">Bug</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2018/02/25/hhutraining3/">HHUACM 寒假专题 动态规划</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/01/16/CSP超级合集/">CSP超级合集（更新中）</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/10/18/zimpha的bc出题录/">zimpha的bc出题录（部分）</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/09/25/2017urumqi_online/">2017ICPC乌鲁木齐网络赛 全题解</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/27/SAM/">后缀自动机·基本概念</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/23/2017multi9/">2017年多校联训9 部分题解</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/20/hdu6158/">hdu 6158 The Designer</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/20/hdu6156/">hdu 6156 Palindrome Function</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/18/2017multi8/">2017年多校联训8 部分题解</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2017/08/17/hihocoder1553/">hihocoder 1553 区间统计</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://www.lovelywen.com/" title="wenwenla" target="_blank">wenwenla</a><ul></ul><a href="http://www.calvinneo.com/" title="Calvin Neo" target="_blank">Calvin Neo</a><ul></ul><a href="http://www.cnblogs.com/forever97" title="Forever97" target="_blank">Forever97</a><ul></ul><a href="http://blog.csdn.net/miracle_ma" title="Mashaonan" target="_blank">Mashaonan</a><ul></ul><a href="http://liziyang.space/" title="lizi" target="_blank">lizi</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/blog/." rel="nofollow">——Light!.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/blog/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/blog/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=0.0.0"></script></div></body></html>